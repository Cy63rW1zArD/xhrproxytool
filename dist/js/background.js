!function(){"use strict";window.XHRPT={init:function(){var e=this;e.initConnect()},initConnect:function(){var e=this;chrome.extension.onConnect.addListener(function(t){switch(t.name){case"send-request":e.sendRequestHandler(t)}})},sendRequestHandler:function(e){e.onMessage.addListener(function(t){var n=new XMLHttpRequest,s="",a=t.method.toUpperCase(),r=t.url.trim();/^https?\:/.test(r)||(r="http://"+r);var o=t.headers||{};o["Content-Type"]||(o["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8");for(var i in t.data)s&&(s+="&"),s+=i+"="+t.data[i];if("GET"===a)s&&(r+="?"+s);else if("application/json"===o["Content-Type"])s=JSON.stringify(t.data);else if("multipart/form-data"===o["Content-Type"]){var d=new FormData;Object.keys(t.data).forEach(function(e){d.append(e,t.data[e])}),s=d}n.open(a,r,!0);for(var p in o)n.setRequestHeader(p,o[p]);n.onreadystatechange=function(){if(4===this.readyState){var s={},a=["readyState","response","responseText","responseType","responseURL","responseXML","status","statusText","timeout","withCredentials"];a.forEach(function(e){s[e]=n[e]}),s.responseHeaders=this.getAllResponseHeaders(),chrome.tabs.sendRequest(e.sender.tab.id,{name:"send-request-res",data:n.responseText,reqData:t,xhr:s})}},n.send(s)})}},window.XHRPT.init()}();